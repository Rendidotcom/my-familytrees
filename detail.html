<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Detail Anggota</title>
<style>
body{font-family:Arial;background:#eef1f5;display:flex;justify-content:center;}
.box{background:white;padding:20px;margin-top:40px;width:90%;max-width:400px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
img{width:120px;height:120px;border-radius:50%;object-fit:cover;margin:auto;display:block;}
button{width:100%;padding:12px;margin-top:10px;border:none;border-radius:8px;cursor:pointer;}
.btn-edit{background:#4A90E2;color:white;}
.btn-delete{background:#e74c3c;color:white;}
.btn-back{background:#7f8c8d;color:white;}
</style>
</head>
<body>

<div class="box">
    <div id="content">Memuat...</div>

    <button class="btn-edit" id="editBtn">Edit</button>
    <button class="btn-delete" id="deleteBtn">Hapus</button>
    <button class="btn-back" onclick="history.back()">Kembali</button>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzRvMj-bFP08nZMXK1rEnAX7ZvOd46OK-r1bZ4ugT-2rV8vs9VpI1G_APZMJ-3AgBXlRw/exec";
const urlParams = new URLSearchParams(window.location.search);
const id = urlParams.get("id");

// Load detail
async function loadDetail(){
    const res = await fetch(API_URL + "?mode=getData");
    const json = await res.json();
    const item = json.data.find(x => x.id === id);

    if(!item){ 
        document.getElementById("content").innerHTML = "Data tidak ditemukan"; 
        return; 
    }

    document.getElementById("content").innerHTML = `
        <img src="${item.photoURL || 'https://via.placeholder.com/120'}">
        <h3 style="text-align:center;">${item.name}</h3>
        <p><b>Domisili:</b> ${item.domisili}</p>
        <p><b>Hubungan:</b> ${item.relationship}</p>
        <p><b>Notes:</b> ${item.notes || '-'}</p>
    `;

    document.getElementById("editBtn").onclick = ()=> {
        window.location = "edit.html?id=" + id;
    };
}
loadDetail();

// DELETE
document.getElementById("deleteBtn").onclick = async ()=>{
    if(!confirm("Yakin ingin menghapus?")) return;

    const res = await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ mode: "delete", id })
    });
    const json = await res.json();

    alert(json.message);
    window.location = "dashboard.html";
};
</script>

</body>
</html>
