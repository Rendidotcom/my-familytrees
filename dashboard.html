<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Anggota Keluarga</title>

<style>
body {
  font-family: Arial;
  background: #eef1f5;
  margin: 0;
  padding: 0;
}

h2 {
  text-align: center;
  padding: 20px;
  color: #333;
}

#list {
  width: 90%;
  max-width: 900px;
  margin: 20px auto;
  background: white;
  padding: 20px;
  border-radius: 15px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.10);
}

.member {
  display: flex;
  align-items: center;
  padding: 14px 10px;
  border-bottom: 1px solid #ddd;
}

.member:last-child {
  border-bottom: none;
}

.member img {
  width: 65px;
  height: 65px;
  border-radius: 50%;
  object-fit: cover;
  margin-right: 18px;
}

.member-info {
  flex: 1;
}

.member-info h4 {
  margin: 0;
  color: #333;
  font-size: 17px;
}

.member-info p {
  margin: 2px 0;
  font-size: 13px;
  color: #777;
}

.member-buttons button {
  padding: 8px 12px;
  margin-left: 6px;
  font-size: 12px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
}

.btn-detail { background: #4A90E2; color: white; }
.btn-edit   { background: #27ae60; color: white; }
.btn-del    { background: #e74c3c; color: white; }

.empty {
  text-align: center;
  padding: 20px;
  color: #777;
}
</style>
</head>

<body>

<h2>ðŸ“‹ Daftar Anggota Keluarga</h2>

<div id="list">Memuat data...</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzRvMj-bFP08nZMXK1rEnAX7ZvOd46OK-r1bZ4ugT-2rV8vs9VpI1G_APZMJ-3AgBXlRw/exec";

// LOAD DATA
async function loadData() {
    document.getElementById("list").innerHTML = "Memuat data...";

    const res = await fetch(API_URL + "?mode=getData");
    const json = await res.json();

    if (!json.data || json.data.length === 0) {
        document.getElementById("list").innerHTML = `<div class="empty">Belum ada data</div>`;
        return;
    }

    let html = "";
    json.data.forEach(item => {
        html += `
            <div class="member">
                <img src="${item.photoURL || 'https://via.placeholder.com/65'}">

                <div class="member-info">
                    <h4>${item.name}</h4>
                    <p>${item.relationship} â€¢ ${item.domisili}</p>
                </div>

                <div class="member-buttons">
                    <button class="btn-detail" onclick="openDetail('${item.id}')">Detail</button>
                    <button class="btn-edit" onclick="openEdit('${item.id}')">Edit</button>
                    <button class="btn-del" onclick="deleteMember('${item.id}')">Hapus</button>
                </div>
            </div>
        `;
    });

    document.getElementById("list").innerHTML = html;
}

function openDetail(id) {
    window.location = "detail.html?id=" + id;
}

function openEdit(id) {
    window.location = "edit.html?id=" + id;
}

// DELETE DATA
async function deleteMember(id) {
    if (!confirm("Yakin ingin menghapus anggota ini?")) return;

    const res = await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({ mode: "delete", id })
    });

    const json = await res.json();
    alert(json.message || "Dihapus");
    loadData();
}

loadData();
</script>

</body>
</html>
